// src/shared/api/mocks/handlers/postHandlers.ts
import { http, HttpResponse } from 'msw';

export const postHandlers = [
  http.get('/api/posts/categories', () => {
    return HttpResponse.json([
      {
        code: 'ALL',
        displayName: '전체',
      },
      {
        code: 'FREE',
        displayName: '자유',
      },
      {
        code: 'STUDY',
        displayName: '학업',
      },
      {
        code: 'CAREER',
        displayName: '진로취업',
      },
      {
        code: 'RELATIONSHIP',
        displayName: '대인관계',
      },
      {
        code: 'SOCIAL',
        displayName: '사회생활',
      },
      {
        code: 'FAMILY',
        displayName: '가족',
      },
      {
        code: 'HOBBY',
        displayName: '취미',
      },
      {
        code: 'MENTAL',
        displayName: '정신건강',
      },
      {
        code: 'TROUBLE',
        displayName: '고민상담',
      },
    ]);
  }),
  http.get('/api/posts/category/:code', ({ request, params }) => {
    const code = params.code as string;
    const url = new URL(request.url);
    const page = parseInt(url.searchParams.get('page') ?? '0', 10);
    const size = parseInt(url.searchParams.get('size') ?? '10', 10);

    const allPosts = [
      {
        id: 1,
        postCategory: 'FREE',
        postCategoryName: '자유',
        title: '자유 게시글 1',
        content: '자유 게시글 내용 1',
        author: 'user1',
        likeCount: 5,
        viewCount: 100,
        commentCount: 2,
        createdAt: '2024-06-01T10:00:00Z',
      },
      {
        id: 2,
        postCategory: 'FREE',
        postCategoryName: '자유',
        title: '자유 게시글 2',
        content: '자유 게시글 내용 2',
        author: 'user2',
        likeCount: 3,
        viewCount: 50,
        commentCount: 1,
        createdAt: '2024-06-02T11:00:00Z',
      },
      {
        id: 3,
        postCategory: 'STUDY',
        postCategoryName: '학업',
        title: '학업 게시글 1',
        content: '학업 관련 질문이 있습니다.',
        author: 'student1',
        likeCount: 7,
        viewCount: 80,
        commentCount: 4,
        createdAt: '2024-06-03T09:00:00Z',
      },
      {
        id: 4,
        postCategory: 'CAREER',
        postCategoryName: '진로취업',
        title: '진로 고민 나눔',
        content: '진로에 대해 고민이 많아요.',
        author: 'career_guy',
        likeCount: 10,
        viewCount: 120,
        commentCount: 5,
        createdAt: '2024-06-04T13:00:00Z',
      },
      {
        id: 5,
        postCategory: 'RELATIONSHIP',
        postCategoryName: '대인관계',
        title: '친구와의 갈등',
        content: '친구와 다툼이 있었어요.',
        author: 'user_friend',
        likeCount: 2,
        viewCount: 30,
        commentCount: 0,
        createdAt: '2024-06-05T15:00:00Z',
      },
      {
        id: 6,
        postCategory: 'SOCIAL',
        postCategoryName: '사회생활',
        title: '첫 직장 생활',
        content: '사회 초년생의 고민입니다.',
        author: 'newbie',
        likeCount: 6,
        viewCount: 70,
        commentCount: 3,
        createdAt: '2024-06-06T18:00:00Z',
      },
      {
        id: 7,
        postCategory: 'FAMILY',
        postCategoryName: '가족',
        title: '가족과의 시간',
        content: '가족과의 소중한 추억을 나눠요.',
        author: 'familyman',
        likeCount: 8,
        viewCount: 90,
        commentCount: 2,
        createdAt: '2024-06-07T20:00:00Z',
      },
      {
        id: 8,
        postCategory: 'HOBBY',
        postCategoryName: '취미',
        title: '요즘 빠진 취미',
        content: '새로운 취미를 시작했습니다.',
        author: 'hobbyist',
        likeCount: 4,
        viewCount: 40,
        commentCount: 1,
        createdAt: '2024-06-08T08:00:00Z',
      },
      {
        id: 9,
        postCategory: 'MENTAL',
        postCategoryName: '정신건강',
        title: '스트레스 해소법',
        content: '스트레스를 어떻게 푸시나요?',
        author: 'mindcare',
        likeCount: 9,
        viewCount: 110,
        commentCount: 6,
        createdAt: '2024-06-09T11:30:00Z',
      },
      {
        id: 10,
        postCategory: 'TROUBLE',
        postCategoryName: '고민상담',
        title: '고민 상담 부탁드려요',
        content: '최근 고민이 많아 글 남깁니다.',
        author: 'troubled',
        likeCount: 1,
        viewCount: 20,
        commentCount: 0,
        createdAt: '2024-06-10T12:00:00Z',
      },
      {
        id: 11,
        postCategory: 'FREE',
        postCategoryName: '자유',
        title: '오늘의 일상',
        content: '오늘은 날씨가 좋네요.',
        author: 'user3',
        likeCount: 2,
        viewCount: 18,
        commentCount: 0,
        createdAt: '2024-06-11T09:00:00Z',
      },
      {
        id: 12,
        postCategory: 'STUDY',
        postCategoryName: '학업',
        title: '공부 팁 공유',
        content: '효율적인 공부법을 공유합니다.',
        author: 'studyking',
        likeCount: 4,
        viewCount: 35,
        commentCount: 2,
        createdAt: '2024-06-12T10:00:00Z',
      },
      {
        id: 13,
        postCategory: 'CAREER',
        postCategoryName: '진로취업',
        title: '면접 후기',
        content: '최근 면접 경험을 공유합니다.',
        author: 'jobseeker',
        likeCount: 7,
        viewCount: 65,
        commentCount: 3,
        createdAt: '2024-06-13T17:00:00Z',
      },
      {
        id: 14,
        postCategory: 'RELATIONSHIP',
        postCategoryName: '대인관계',
        title: '친구 사귀기',
        content: '새로운 친구를 만드는 방법?',
        author: 'friend_maker',
        likeCount: 3,
        viewCount: 25,
        commentCount: 1,
        createdAt: '2024-06-14T14:00:00Z',
      },
      {
        id: 15,
        postCategory: 'SOCIAL',
        postCategoryName: '사회생활',
        title: '직장 내 인간관계',
        content: '직장에서의 인간관계 조언 구합니다.',
        author: 'workerbee',
        likeCount: 5,
        viewCount: 55,
        commentCount: 2,
        createdAt: '2024-06-15T19:00:00Z',
      },
      {
        id: 16,
        postCategory: 'FAMILY',
        postCategoryName: '가족',
        title: '부모님과의 대화',
        content: '부모님과 잘 지내는 방법?',
        author: 'child',
        likeCount: 6,
        viewCount: 38,
        commentCount: 1,
        createdAt: '2024-06-16T13:30:00Z',
      },
      {
        id: 17,
        postCategory: 'HOBBY',
        postCategoryName: '취미',
        title: '취미 추천',
        content: '새로운 취미가 필요해요.',
        author: 'explorer',
        likeCount: 1,
        viewCount: 15,
        commentCount: 0,
        createdAt: '2024-06-17T09:10:00Z',
      },
      {
        id: 18,
        postCategory: 'MENTAL',
        postCategoryName: '정신건강',
        title: '불안감 극복',
        content: '불안감을 이겨내는 방법을 찾고 있어요.',
        author: 'anxious',
        likeCount: 3,
        viewCount: 22,
        commentCount: 1,
        createdAt: '2024-06-18T15:20:00Z',
      },
      {
        id: 19,
        postCategory: 'TROUBLE',
        postCategoryName: '고민상담',
        title: '진로 고민 상담',
        content: '진로에 대한 고민이 많아요.',
        author: 'mentor',
        likeCount: 2,
        viewCount: 27,
        commentCount: 1,
        createdAt: '2024-06-19T18:00:00Z',
      },
      {
        id: 20,
        postCategory: 'FREE',
        postCategoryName: '자유',
        title: '잡담해요',
        content: '아무 말이나 자유롭게!',
        author: 'freebird',
        likeCount: 0,
        viewCount: 10,
        commentCount: 0,
        createdAt: '2024-06-20T22:00:00Z',
      },
    ];

    // Filter posts by category code if not 'ALL'
    const filteredPosts =
      code === 'ALL' ? allPosts : allPosts.filter((post) => post.postCategory === code);

    const totalElements = filteredPosts.length;
    const totalPages = Math.ceil(totalElements / size);
    const start = page * size;
    const end = start + size;
    const content = filteredPosts.slice(start, end);
    const last = page >= totalPages - 1;

    return HttpResponse.json({
      page,
      content,
      size,
      totalElements,
      totalPages,
      last,
    });
  }),
];
